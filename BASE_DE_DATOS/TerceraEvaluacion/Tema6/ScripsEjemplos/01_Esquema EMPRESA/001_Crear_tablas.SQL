--CREACIÓN ESQUEMA LÓGICO EMPRESA
--SOLUCIÓN ACADÉMICA
    --CLAVE AJENA REFLEXIVA CREADA DESDE EL PRINCIPIO

CREATE TABLE ARTICULO ( 
CODART      VARCHAR2(8) 
            CONSTRAINT ARTICULO_PK PRIMARY KEY,
DESCRIP     VARCHAR2(50),
PRECIO      NUMBER(7,2),
STOCK       NUMBER(6),
STOCK_MIN   NUMBER(6)
);

CREATE TABLE PROVINCIA ( 
CODPROV     VARCHAR2(2) 
            CONSTRAINT PROVINCIA_PK PRIMARY KEY,
NOMBRE      VARCHAR2(50)
);

CREATE TABLE LOCALIDAD ( 
CODLOC      VARCHAR2(5) 
            CONSTRAINT LOCALIDAD_PK PRIMARY KEY,
NOMBRE      VARCHAR2(50),
CODPROV     VARCHAR2(2) 
            CONSTRAINT LOCALIDAD_PROVINCIA_FK REFERENCES PROVINCIA
);
 
CREATE TABLE CPOSTAL ( 
CODPOSTAL   VARCHAR2(5) 
            CONSTRAINT CPOSTAL_PK PRIMARY KEY,
CODLOC      VARCHAR2(5) 
            CONSTRAINT CPOSTAL_LOCALIDAD_FK REFERENCES LOCALIDAD
); 

CREATE TABLE CLIENTE ( 
CODCLI      NUMBER(5) 
            CONSTRAINT CLIENTE_PK PRIMARY KEY,
NOMBRE      VARCHAR2(50),
DIRECCION   VARCHAR2(50),
CODPOSTAL   VARCHAR2(5) 
            CONSTRAINT CLIENTE_CPOSTAL_FK REFERENCES CPOSTAL
);  

CREATE TABLE VENDEDOR ( 
CODVEN      NUMBER(5) 
            CONSTRAINT VENDEDOR_PK PRIMARY KEY,
NOMBRE      VARCHAR2(50),
DIRECCION   VARCHAR2(50),
CODPOSTAL   VARCHAR2(5) 
            CONSTRAINT VENDEDOR_CPOSTAL_FK REFERENCES CPOSTAL,
CODJEFE     NUMBER(5)
            CONSTRAINT VENDEDOR_VENDEDOR_FK REFERENCES VENDEDOR (CODVEN)
);  

CREATE TABLE FACTURA ( 
CODFAC      NUMBER(6) 
            CONSTRAINT FACTURA_PK PRIMARY KEY,
FECHA       DATE,
CODCLI      NUMBER(5) 
            CONSTRAINT FACTURA_CLIENTE_FK REFERENCES CLIENTE,
CODVEN      NUMBER(5) 
            CONSTRAINT FACTURA_VENDEDOR_FK REFERENCES VENDEDOR,
IVA         NUMBER(2),
DTO         NUMBER(2)
);

CREATE TABLE FACTURA_LINEA ( 
CODFAC      NUMBER(6)
            CONSTRAINT FACTURA_LINEA_FACTURA_FK REFERENCES FACTURA,
LINEA       NUMBER(2),
CANT        NUMBER(5) ,
CODART      VARCHAR2(8) 
            CONSTRAINT FACTURA_LINEA_ARTICULO_FK REFERENCES ARTICULO,
PRECIO      NUMBER(7,2),
DTO         NUMBER(2),
CONSTRAINT FACTURA_LINEA_PK PRIMARY KEY (CODFAC, LINEA)
);